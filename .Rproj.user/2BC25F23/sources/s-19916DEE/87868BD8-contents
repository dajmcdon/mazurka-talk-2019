\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Switching models for musical interpretation},
            pdfauthor={Daniel J. McDonald},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Switching models for musical interpretation}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Daniel J. McDonald}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{22 November 2019}


\begin{document}
\maketitle

\hypertarget{disclaimer}{%
\subsection{Disclaimer}\label{disclaimer}}

.pull-left{[} \#\#\#\# Inference + Optimization + Approximation

Approximation for Least squares \((n \gg p)\) - Homrighausen and
.green{[}McDonald{]}. (2019+). JCGS.

Approximation for dimension reduction \((p \gg n)\)\\
- Homrighausen and .green{[}McDonald{]}. (2016). JCGS. - Ding and
.green{[}McDonald{]}. (2017). Bioinformatics. - Ding and
.green{[}McDonald{]}. (2019). Under review.

Algorithms for large data - .green{[}McDonald{]}. ADMM for large
constrained kernel PCA. - .green{[}McDonald{]} and Khodadadi. (2019).
AAAI. - .green{[}McDonald{]}, Sharpnack, Bassett, and Sadhanala. Trend
filtering for Spatio-temporal exponential families. {]}

.pull-right{[} \#\#\#\# Tuning parameter selection and risk estimation
and nonparametrics

Model selection and penalized M-estimators - Homrighausen and
.green{[}McDonald{]}. (2013). ICML. - Homrighausen and
.green{[}McDonald{]}. (2014). Machine Learning. - Homrighausen and
.green{[}McDonald{]}. (2017). Stat. Sinica. - .green{[}McDonald{]}. SURE
for exponential families.

Dependence and high dimensions - Homrighausen and .green{[}McDonald{]}.
(2018). JSCS. - .green{[}McDonald{]} and Shalizi. (2018+). Under review.
- .green{[}McDonald{]}, Shalizi and Schervish. (2017). JMLR. -
.green{[}McDonald{]}. (2017). AISTATS. - .green{[}McDonald{]}. Minimax
non-parametric regression. {]}

???

\begin{itemize}
\item
  Not my usual research area
\item
  more of a ``side project''
\item
  but one I care about a lot
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

background-image: url(``gfx/State-cello-0299.jpg'') background-size:
contain

??? Music major

Conservatory

\hypertarget{musical-taste}{%
\subsection{Musical taste}\label{musical-taste}}

\begin{itemize}
\item
  Easy to describe music you like:

  \begin{itemize}
  \tightlist
  \item
    ``Jazzy sound''
  \item
    ``Strong beat''
  \item
    ``good lyrics''
  \item
    ``anything by Taylor Swift''
  \end{itemize}
\item
  Harder to describe a .red{[}performance{]}
\item
  Classical music is mainly about performances of the .red{[}same{]}
  music
\item
  How do we think about which ones we like?
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{primer-on-classical-music}{%
\subsection{Primer on ``classical''
music}\label{primer-on-classical-music}}

\begin{itemize}
\item
  Written between 6th century and today
\item
  Includes music written during the Classical period (1750--1820)
\end{itemize}

The real difference is that when a composer writes a piece of what's
usually called classical music, he puts down the exact notes that he
wants, the exact instruments or voices that he wants to play or sing
those notes---even the exact number of instruments or voices; and he
also writes down as many directions as he can think of.

\begin{itemize}
\tightlist
\item
  Generally much more ``musically'' complicated
\end{itemize}

.center{[}{]}

???

\begin{itemize}
\item
  Musically complicated = wider range of chords, keys, instrumentation,
  contrasts
\item
  Hey Jude: 3 chords (2 others briefly) in 7 minutes. Same key the whole
  time.
\item
  For today, Chopin is running example
\item
  Chopin: 6 unique chords in first 10 seconds. Two key areas in 1.5
  minutes of music.
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

class: middle

.pull-left{[} {]}

.pull-right{[} {]}

???

Which one do you like better?

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{whats-different}{%
\subsection{What's different?}\label{whats-different}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Mistakes
\item
  Extraneous noise
\item
  Recording quality
\item
  Articulation/Legato/Bowing/Breathing
\item
  Dynamics
\item
  Tempo/Rubato
\end{enumerate}

???

The first three are uninteresting.

The others are about .red{[}.bold{[}interpretation{]}{]}

We like performances with ``better'' interpretations

\hypertarget{musical-tempo}{%
\subsection{Musical tempo}\label{musical-tempo}}

\begin{center}\includegraphics{gfx/rubinstein-tempo-1} \end{center}

\begin{itemize}
\item
  Notes change ``speed''
\item
  Sometimes purposeful
\item
  Speed is important for .red{[}.bold{[}interpretation{]}{]}
\end{itemize}

\hypertarget{important-musical-terms}{%
\subsection{Important musical terms}\label{important-musical-terms}}

.pull-left-20{[} .green{[}.bolder{[}Notes{]}{]}

.green{[}.bolder{[}Beat{]}{]}

.green{[}.bolder{[}Measure{]}{]}

.green{[}.bolder{[}Time signature{]}{]}

.green{[}.bolder{[}Tempo{]}{]}

.green{[}.bolder{[}Dynamics{]}{]} {]}

.pull-right-80{[} All those little black dots

Strongly felt impetus

Collections of notes delimited by vertical ``barlines''

Number of beats / measure; type of note that gets the beat

The prevailing speed, measured in bpm

Loudness of the note {]}

\begin{center}\includegraphics[width=0.6\linewidth]{gfx/ChopinFirst3} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{data}{%
\subsection{Data}\label{data}}

\begin{itemize}
\tightlist
\item
  CHARM Mazurka Project
\end{itemize}

\begin{center}\includegraphics[width=0.6\linewidth]{gfx/charm} \end{center}

\begin{itemize}
\item
  Focus on timing only (dynamics also available)
\item
  50 recordings: Chopin Mazurka Op. 68 No.~3
\item
  Recorded between 1931 and 2006
\item
  45 different performers
\end{itemize}

class: middle

\begin{center}\includegraphics{gfx/example-perf-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{chopin-mazurkas}{%
\subsection{Chopin \& Mazurkas}\label{chopin-mazurkas}}

.pull-left{[} \#\#\#\# Fryderyk Chopin (1810--1849)

\begin{itemize}
\item
  Born in Poland
\item
  Moved to Paris at 21
\item
  Virtuoso pianist
\item
  Wrote mainly piano music {]}
\end{itemize}

.pull-right{[} \#\#\#\# Mazurka

\begin{itemize}
\item
  A Polish dance
\item
  Chopin composed at least 58 for Piano
\item
  Repetition is very important
\item
  Certain rhythmic figures
\end{itemize}

{]}

???

Everything he wrote includes piano

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

background-image: url(``gfx/entire-mazurka.jpg'') background-position:
center background-size: contain

???

Tempo markings, importantly, only 2 + rit and fermata

Dotted eighth sixteenth

ABA structure

Minor phrases

Repetition

Chord progression

\hypertarget{thinking-about-tempo}{%
\subsection{Thinking about tempo}\label{thinking-about-tempo}}

.pull-left{[} 1. Playing in tempo

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  Accelerando (speed up)
\item
  Allargando (slow down)
\item
  Tenuto (emphasis) {]}
\end{enumerate}

.pull-right{[}
\includegraphics{https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Metronome_Mälzel_1.jpg/291px-Metronome_Mälzel_1.jpg}{]}

\hypertarget{intentions-vs.-observations}{%
\subsection{Intentions
vs.~observations}\label{intentions-vs.-observations}}

\begin{center}\includegraphics[width=0.8\linewidth]{gfx/ss-mod-flow} \end{center}

???

Musicians aren't perfect.

Observe noisy realization

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{switching-state-space-models}{%
\subsection{Switching state space
models}\label{switching-state-space-models}}

.pull-left{[}

Economics (Kim and Nelson, 1998; Chauvet and Piger, 2008)

{]} .pull-right{[}

Animal movement (Patterson, et al., 2008; Block, et al., 2011)

{]}

NLP (Fox, et al., 2011)

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{inference}{%
\subsection{Inference}\label{inference}}

\begin{itemize}
\item
  Also unknown parameters \(\theta\)
\item
  If you know \(\{S_k\}_{k=1}^n\) and \(\theta\), Kalman filter gives
  \(\{\hat{X}_k\}_{k=1}^n\)
\item
  If you know \(\{X_k\}_{k=1}^n\) and \(\theta\), Viterbi algorithm
  gives \(\{\hat{S}_k\}_{k=1}^n\)
\item
  We need to learn \(\{S_k,\ X_k\}_{k=1}^n\)
\item
  And we need to estimate \(\theta\)
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{kalman-filter}{%
\subsection{Kalman filter}\label{kalman-filter}}

\begin{itemize}
\tightlist
\item
  Developed in the late '50s to track missiles
\end{itemize}

\[
\begin{aligned}
X_{k+1} &= d_k + T_k X_k + \eta_{k+1} & \eta_{k+1} &\sim \textrm{N}(0, Q_{k+1})\\
Y_k &= c_k + Z_k X_k + \epsilon_{k}&\epsilon_k & \sim \textrm{N}(0, G_k)\\
\end{aligned}
\]

\begin{itemize}
\item
  Assume \(X_0\) is Gaussian
\item
  Just track mean and variance of \(X_k\ |\ \{Y_i\}_{i=1}^k\)
\item
  Does this iteratively for each \(k\)
\item
  Gives ``filter'' estimate of \(\{X_k\}_{k=1}^n\) and likelihood
\end{itemize}

??? Here At and Zt and the components of epsilon are contained in theta

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{switching-kalman-filter-for-our-model}{%
\subsection{Switching Kalman filter (for our
model)}\label{switching-kalman-filter-for-our-model}}

.pull-left{[} \[
\begin{aligned}
X_{k+1} &= d(s_t,s_{k-1}) + T(s_k,s_{k-1}) X_k + \eta_{k+1}\\
Y_t &= c(s_k) + Z(s_k) X_k + \epsilon_{k}\\\\
\eta_{k} &\sim \textrm{N}(0, Q(s_k,s_{k-1}))\\
\epsilon_k & \sim \textrm{N}(0, G(s_k))
\end{aligned}
\]{]}

.pull-right{[}

\begin{center}\includegraphics[width=10\linewidth]{gfx/ss-mod-flow} \end{center}

{]}

\hypertarget{step-kalman-filter-.greenkalman}{%
\subsection{\texorpdfstring{1-step Kalman filter ---
.green{[}\texttt{kalman()}{]}}{1-step Kalman filter --- .green{[}kalman(){]}}}\label{step-kalman-filter-.greenkalman}}

Get estimates of \(X_{k}\) given a new observation \(y_k\)

Input: * New data --- \(y_k\), * Parameter matrices --- \(d_k\),
\(c_k\), \(T_k\), \(Z_k\), \(Q_k\), \(G_k\), * Previous state mean and
variance --- \(x_{k-1}\), \(P_{k-1}\)

Predict new state \(\longrightarrow \hat{x}_k = d + Tx_{k-1}\)  
\(\hat{P}_k = Q+TP_{k-1}T^\top\)

Predict current data \(\longrightarrow \hat{y}_k = c + Z\hat{x}_k\)  
\(F=G + Z\hat{P}_kZ^\top\)

Calculate error \(\longrightarrow v = y_k - \hat{y}_k\)  
\(K = \hat{P}_kZ^\top F^{-1}\)

Update \(\longrightarrow x_k = \hat{x}_k + Kv\)  
\(P_k = \hat{P}_k(I - Z^\top K)\)

Log Likelihood
\(\longrightarrow \ell_k(\theta) \propto \ell_{k-1}(\theta) - v^\top F^{-1} v - \log(|F|)\)

???

If know S, then that pins down all the parameter matrices

Loop this over 1 \ldots{} n

Maximize over theta

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{we-dont-know-the-discrete-states}{%
\subsection{We don't know the discrete
states}\label{we-dont-know-the-discrete-states}}

Pretend there are only 2 states

\hypertarget{htmlwidget-bb71a0dd74f9054ac3ad}{}

.Large{[}\emph{k} = .orange{[}1{]}, .dark-blue{[}2{]}, .red{[}3{]},
.green{[}4{]}{]}

???

I have 4 states

2nd order Markov

Leads to 11 states in 1-Markov

Piece has 231 notes

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

class: middle, center, inverse

\hypertarget{section}{%
\subsection{3,645,000,000,000,000,000,000,000,000,000,000,000,}\label{section}}

\hypertarget{section-1}{%
\subsection{000,000,000,000,000,000,000,000,000,000,000,000,}\label{section-1}}

\hypertarget{section-2}{%
\subsection{000,000,000,000,000,000,000,000,000,000,000,000,}\label{section-2}}

\hypertarget{section-3}{%
\subsection{000,000,000,000,000,000,000,000,000,000,000,000,}\label{section-3}}

\hypertarget{section-4}{%
\subsection{000,000,000,000,000,000,000,000,000,000,000,000,}\label{section-4}}

\hypertarget{section-5}{%
\subsection{000,000,000,000,000,000,000,000,000,000,000,000,}\label{section-5}}

\hypertarget{section-6}{%
\subsection{000,000,000,000,000,000,000,000}\label{section-6}}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{discrete-particle-filter-.greendpf}{%
\subsection{\texorpdfstring{Discrete particle filter ---
.green{[}\texttt{dpf()}{]}}{Discrete particle filter --- .green{[}dpf(){]}}}\label{discrete-particle-filter-.greendpf}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Track at most \(J\) paths through the \(M^n\) tree
\item
  At time \(k\), given \(J\) paths, propogate each one forward
\item
  Sample the \(JM\) possibilities to get only \(J\)
\item
  iterate forward through time until done
\end{enumerate}

\hypertarget{htmlwidget-7213c25410ed5ffd3435}{}

???

This is a greedy approximation

The sampling step is important

Probability of sampling is proportional to current weight times
likelihood times trans prob

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{the-complete-algorithm}{%
\subsection{The complete algorithm}\label{the-complete-algorithm}}

For each performance:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Guess a parameter vector \(\theta\)
\item
  .green{[}\texttt{dpf()}{]} gives greedy state sequence
  \(\{\hat{S}_k\}_{k=1}^n\)
\item
  It gives the likelihood as a side effect via
  .green{[}\texttt{kfilter()}{]}
\item
  Iterate 1--3 to maximize for \(\theta \in \Theta\)
\item
  Run the .green{[}\texttt{ksmoother()}{]} to get estimate for
  \(\{X_k\}_{k=1}^n\)
\end{enumerate}

???

kfilter() 1 step appears in dpf()

ksmoother() is conditional on all the data

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

class: middle, center

\begin{center}\includegraphics{gfx/two-perfs-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

class: middle, center, inverse

\hypertarget{similar-performances}{%
\section{Similar performances}\label{similar-performances}}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{the-estimated-parameters}{%
\subsection{The estimated parameters}\label{the-estimated-parameters}}

For each performance, we estimate \(\theta\) by penalized maximum
likelihood.

The parameters are things like:

\begin{itemize}
\tightlist
\item
  average speed in different states
\item
  some variance parameters
\item
  transition probabilities
\end{itemize}

We have strong prior information.

??? Examples of strong priors

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/estimated-parm-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{distance-matrix-on-parameters}{%
\subsection{Distance matrix on
parameters}\label{distance-matrix-on-parameters}}

.pull-left-40{[} * Use Mahalanobis distance on \(\theta\)
\[d(\theta_1,\theta_2) = \sqrt{(\theta_1-\theta_2)^\top V^{-1}(\theta_1-\theta_2)} \]

\begin{itemize}
\item
  \(V\) is prior covariance matrix
\item
  Incorporates correlations correctly on probability vectors
\item
  Some performances have no ``close'' neighbors {]}
\end{itemize}

.pull-right-60{[}

\begin{center}\includegraphics{gfx/parametric-clusters-1} \end{center}

{]}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/other-removed-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/clustered-parameters-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{probability-of-stress}{%
\subsection{Probability of ``stress''}\label{probability-of-stress}}

\begin{center}\includegraphics{gfx/clustered-p14-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/clust-1-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/clust-2-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/similar-perfs-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\includegraphics{gfx/rubinstein-perfs-1} \end{center}

class: middle, center, inverse

{[}

Examining performances and parameters

{]}(\url{https://dajmcdon.shinyapps.io/ChopinMazurkaApp/})

???

Show Cortot recording again. Contrast with Tomsic parameter.

Is it Cortot?

The Hatto Scandal of the Concert Artist Label

\emph{Beyond the Score: Music as Performance} by Nicholas Cook

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{why-a-switching-model}{%
\subsection{Why a switching model?}\label{why-a-switching-model}}

\begin{itemize}
\item
  Most statistical methods for estimating functions assume
  ``smoothness''
\item
  Trend filtering, splines, wavelets
\end{itemize}

--

\begin{center}\includegraphics{gfx/alternative-smoothers-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{model-fragility}{%
\subsection{Model fragility}\label{model-fragility}}

\begin{center}\includegraphics{gfx/bad-model-1} \end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{in-summary}{%
\subsection{In summary}\label{in-summary}}

\begin{itemize}
\item
  We develop a switching model for tempo decisions
\item
  We give an algorithm for performing likelihood inference
\item
  We estimate our model using a large collection of recordings of the
  same composition
\item
  We demonstrate how the model is able to recover performer intentions
\item
  We use the learned representations to compare and contrast recordings
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{future-work}{%
\subsection{Future work}\label{future-work}}

\begin{itemize}
\item
  Similar idea for dynamics here, examine the combination
\item
  Working on an extension to vocal music, glissandi, vibrato, scooping,
  etc.
\item
  Want a fast implementation to use for teaching
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{collaborators-etc.}{%
\subsection{Collaborators, etc.}\label{collaborators-etc.}}

.pull-left{[}

{]}

.pull-right{[}

{]}


\end{document}
